<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock - Mosley Auto | Best Cars in Los Santos!</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üöó</text></svg>">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo-section">
                <h1 class="logo">MOSLEY AUTO</h1>
                <p class="tagline">‚òÖ BEST DEALS IN LOS SANTOS! ‚òÖ</p>
            </div>
            <nav class="nav">
                <a href="index.html" class="nav-link">HOME</a>
                <a href="stock.html" class="nav-link active">STOCK</a>
                <a href="team.html" class="nav-link">TEAM</a>
                <a href="contact.html" class="nav-link">CONTACT</a>
            </nav>
        </header>

        <main class="main-content">
            <section class="hero">
                <div class="hero-banner">
                    <h2 class="hero-title">üöó OUR AMAZING STOCK! üöó</h2>
                    <p class="hero-subtitle">QUALITY CARS AT UNBEATABLE PRICES!</p>
                    <div class="promo-badges">
                        <span class="badge">‚òÖ ALL CARS INSPECTED ‚òÖ</span>
                        <span class="badge">‚òÖ WARRANTY INCLUDED ‚òÖ</span>
                        <span class="badge">‚òÖ FINANCING AVAILABLE ‚òÖ</span>
                    </div>
                </div>
            </section>

            <section class="stock-section">
                <div id="loading" class="no-stock">
                    <h3>üîÑ LOADING OUR AMAZING CARS... üîÑ</h3>
                    <p>Please wait while we fetch our latest inventory!</p>
                </div>

                <div id="stock-container" class="stock-grid" style="display: none;">
                    <!-- Cars will be loaded here by JavaScript -->
                </div>

                <div id="no-stock" class="no-stock" style="display: none;">
                    <h3>üö´ NO CARS AVAILABLE RIGHT NOW! üö´</h3>
                    <p>Check back soon for NEW ARRIVALS!</p>
                    <p>Or <a href="contact.html" style="color: #ff0000; font-weight: bold;">CONTACT US</a> to see what's coming in!</p>
                </div>
            </section>
        </main>

        <footer class="footer">
            <p>&copy; 2024 Mosley Auto - mosleyauto.com | Best Cars, Best Prices, Best Service!</p>
        </footer>
    </div>

    <script>
        // Load stock from API
        async function loadStock() {
            try {
                // Add timestamp to prevent caching
                const timestamp = new Date().getTime();
                const response = await fetch(`/api/stock?t=${timestamp}`);
                const data = await response.json();
                
                const loadingEl = document.getElementById('loading');
                const containerEl = document.getElementById('stock-container');
                const noStockEl = document.getElementById('no-stock');
                
                loadingEl.style.display = 'none';
                
                if (data.success && data.vehicles && data.vehicles.length > 0) {
                    containerEl.style.display = 'grid';
                    containerEl.innerHTML = data.vehicles.map(car => `
                        <div class="car-card">
                            <img src="${car.image}" alt="${car.make} ${car.model}" class="car-image" onerror="this.src='data:image/svg+xml,<svg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 300 200\'><rect width=\'300\' height=\'200\' fill=\'%23f0f0f0\'/><text x=\'150\' y=\'100\' text-anchor=\'middle\' fill=\'%23666\' font-size=\'20\'>üöó Car Image</text></svg>'">
                            <div class="car-info">
                                <h3 class="car-title">${car.year} ${car.make} ${car.model}</h3>
                                <p class="car-price">$${car.price.toLocaleString()}</p>
                                <div class="car-details">
                                    <p><strong>Mileage:</strong> ${car.mileage.toLocaleString()} miles</p>
                                    <p><strong>Color:</strong> ${car.color}</p>
                                    <p><strong>Transmission:</strong> ${car.transmission}</p>
                                </div>
                                <p class="car-description">${car.description}</p>
                                <a href="contact.html" class="contact-btn">CONTACT US ABOUT THIS CAR!</a>
                            </div>
                        </div>
                    `).join('');
                } else {
                    noStockEl.style.display = 'block';
                }
            } catch (error) {
                console.error('Error loading stock:', error);
                const loadingEl = document.getElementById('loading');
                const noStockEl = document.getElementById('no-stock');
                
                loadingEl.style.display = 'none';
                noStockEl.style.display = 'block';
                noStockEl.innerHTML = `
                    <h3>‚ö†Ô∏è OOPS! SOMETHING WENT WRONG! ‚ö†Ô∏è</h3>
                    <p>We're having trouble loading our cars right now.</p>
                    <p>Please <a href="contact.html" style="color: #ff0000; font-weight: bold;">CONTACT US</a> directly!</p>
                `;
            }
        }
        
        // Load stock when page loads
        document.addEventListener('DOMContentLoaded', loadStock);
    </script>
</body>
</html>